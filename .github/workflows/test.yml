name: tests
on:
  push:

env:
  ACTIONS_ALLOW_UNSECURE_COMMANDS: true

jobs:
  test:
    timeout-minutes: 10
    runs-on: ubuntu-latest
    name: test
    steps:
      - name: checkout razorpay
        uses: actions/checkout@v2
        with:
          path: ./go/src/github.com/prithvihv/razorpay

      - name: setup go
        uses: actions/setup-go@v2
        with:
          go-version: 1.17

      - name: setup env
        run: |
          echo "::set-env name=GOPATH::${{ github.workspace }}/go"
          echo "::add-path::${{ github.workspace }}/go/bin"
        shell: bash

      - name: test
        run: |
          cd $GOPATH/src/github.com/${{ github.repository }}
          make test
